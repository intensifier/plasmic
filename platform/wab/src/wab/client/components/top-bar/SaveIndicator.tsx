// This is a skeleton starter React component generated by Plasmic.
// This file is owned by you, feel free to edit as you see fit.
import {
  DefaultSaveIndicatorProps,
  PlasmicSaveIndicator,
} from "@/wab/client/plasmic/plasmic_kit_top_bar/PlasmicSaveIndicator";
import { useStudioCtx } from "@/wab/client/studio-ctx/StudioCtx";
import { MaybeWrap } from "@/wab/commons/components/ReactUtil";
import { HTMLElementRefOf } from "@plasmicapp/react-web";
import { Tooltip } from "antd";
import { observer } from "mobx-react";
import * as React from "react";

export type SaveIndicatorProps = DefaultSaveIndicatorProps;

function SaveIndicator_(
  props: SaveIndicatorProps,
  ref: HTMLElementRefOf<"div">
) {
  const studioCtx = useStudioCtx();

  return (
    <MaybeWrap
      cond={studioCtx.needsSaving() || studioCtx.isUnlogged()}
      wrapper={(x) => <Tooltip title="Saving...">{x}</Tooltip>}
    >
      <PlasmicSaveIndicator
        root={{ ref }}
        saveState={
          studioCtx.isUnlogged()
            ? "unlogged"
            : studioCtx.needsSaving()
            ? "dirty"
            : undefined
        }
        {...props}
      />
    </MaybeWrap>
  );
}

const SaveIndicator = observer(React.forwardRef(SaveIndicator_));
export default SaveIndicator;
